<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard - Cannapis</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="sidebar">
    <h2>Cannapis</h2>
    <ul>
      <li class="active" onclick="showSection('home')">Home</li>
      <li onclick="toggleSubmenu()">Produtos</li>
      <ul id="produtos-submenu" class="submenu" style="display: none; padding-left: 20px;">
        <li onclick="showSection('cadastro')">Cadastro</li>
        <li onclick="showSection('consulta')">Consulta</li>
        <li onclick="showSection('relatorio')">Relatório</li>
      </ul>
      <li onclick="showSection('pedidos')">Pedidos</li>
      <li onclick="logout()">Sair</li>
    </ul>
  </div>

  <div class="main-content" id="dashboard-container">
    <header>
      <h1 id="section-title">Home</h1>
    </header>

    <div id="home" class="section active">
      <p>Bem-vindo ao painel administrativo da Cannapis.</p>
    </div>

    <div id="cadastro" class="section">
      <h2>Cadastro de Produtos</h2>
      <div class="product-form-container">
        <form id="product-registration-form">
          <label for="product-type">Tipo de Produto:</label>
          <div class="input-with-button">
            <select id="product-type" name="product-type" required>
              <option value="">Selecione ou Cadastre</option>
              </select>
            <button type="button" onclick="openNewProductTypeModal()">+</button>
          </div>

          <label for="product-name">Nome do Produto: <span class="required">*</span></label>
          <input type="text" id="product-name" name="product-name" required />

          <label for="product-description">Descrição do Produto:</label>
          <textarea id="product-description" name="product-description" rows="4"></textarea>

          <label for="product-price">Preço do Produto: <span class="required">*</span></label>
          <input type="number" id="product-price" name="product-price" step="0.01" min="0" required />

          <div class="form-actions">
            <button type="submit">Salvar</button>
            <button type="button" onclick="editProduct()">Editar</button>
            <button type="button" onclick="deleteProduct()">Excluir</button>
          </div>
        </form>
      </div>

      <div id="new-product-type-modal" class="modal">
        <div class="modal-content">
          <span class="close-button" onclick="closeNewProductTypeModal()">&times;</span>
          <h3>Cadastrar Novo Tipo de Produto</h3>
          <label for="new-product-type-input">Nome do Tipo:</label>
          <input type="text" id="new-product-type-input" placeholder="Ex: Óleo, Cápsula, Creme" />
          <button onclick="saveNewProductTypeToFirestore()">Salvar Tipo</button>
        </div>
      </div>
    </div>

    <div id="consulta" class="section">
      <h2>Consulta de Produtos</h2>
      <div class="product-list-container">
        <table>
          <thead>
            <tr>
              <th>Cód.</th>
              <th>Tipo</th>
              <th>Nome</th>
              <th>Descrição</th>
              <th>Preço</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody id="product-list-body">
            </tbody>
        </table>
        <p id="no-products-message" style="text-align: center; color: #555; display: none;">Nenhum produto cadastrado ainda.</p>
      </div>
    </div>

    <div id="relatorio" class="section">
      <h2>Relatório de Produtos</h2>
      <p>Gere um relatório em PDF dos produtos cadastrados.</p>
      <button onclick="generateProductReportPDF()" class="generate-pdf-btn">Gerar Relatório PDF</button>
      <div id="report-content">
      </div>
    </div>

    <div id="pedidos" class="section">
      <p>Histórico de pedidos realizados.</p>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCQmUL6DG-Ofona0pII6P4tESDoLcqxV8c",
      authDomain: "cannapis-68e37.firebaseapp.com",
      projectId: "cannapis-68e37",
      storageBucket: "cannapis-68e37.firebasestorage.app",
      messagingSenderId: "618285951466",
      appId: "1:618285951466:web:a782c393cffba5b81daa93"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <script src="script.js"></script>
</body>
</html>